<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Assistant</title>
    <link rel="stylesheet" href="CSS.css">
</head>
<body>
    <h1 class="heading">Dwayne, Student Assistant</h1>

    <!-- Task Manager -->
    <div class="container">
        <h2>Task Manager</h2>
        <ul id="taskList">
            <!-- Tasks will be added here dynamically -->
        </ul>
        <div class="add-task">
            <input type="text" id="taskInput" placeholder="New Task">
            <input type="date" id="taskDateInput">
            <button id="addtask" onclick="addTask()">Add Task</button>
        </div>
    </div>

    <!-- Exams -->
    <div class="container">
        <h2>Exams</h2>
        <ul id="examList">
            <!-- Exams will be added here dynamically -->
        </ul>
        <div class="add-exam">
            <input type="text" id="examInput" placeholder="New Exam">
            <input type="date" id="examDateInput">
            <button id="addtask" onclick="addExam()">Add Exam</button>
        </div>
    </div>

    <!-- Study Material -->
    <div class="container">
        <h2>Study Material</h2>
        <ul id="courseList">
            <!-- Courses will be added here dynamically -->
        </ul>
        <div class="add-course">
            <input type="text" id="courseInput" placeholder="New Course">
            <button id="addtask"onclick="addCourse()">Add Course</button>
        </div>
    </div>

    <!-- Grade Tracker -->
    <div class="container">
        <h2>Grade Tracker</h2>
        <table id="gradeTable">
            <thead>
                <tr>
                    <th class="Head">Course</th>
                    <th class="Head">Grade</th>
                </tr>
            </thead>
            <tbody>
                <!-- Grades will be added here dynamically -->
            </tbody>
        </table>
        <div class="add-grade">
            <input type="text" id="courseNameInput" placeholder="Course Name">
            <input type="text" id="gradeInput" placeholder="Grade">
            <button id="addtask" onclick="addGrade()">Add Grade</button>
        </div>

    </div>

    <!-- AI Assistant -->
     <div class="container">
        <h2>AI Assistant</h2>
        <div id="aiChat" class="ai-chat">
            <div class="message ai-message">
                Hello! I'm here to help you with your studies. Ask me anything!</div>
            <br>
            </div>

        <div class="ai-input">
            <input type="text" id="aiInput" placeholder="Ask me a question...">
            <button id="addtask" onclick="askAI()">Send</button>
            <button id="addtask" onclick="askAI()">Ask</button>
        </div>
    </div>

    <script>
       // Initialize data structures
let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
let exams = JSON.parse(localStorage.getItem('exams')) || [];
let courses = JSON.parse(localStorage.getItem('courses')) || [];
let grades = JSON.parse(localStorage.getItem('grades')) || [];

// Save data to localStorage
function saveData() {
    localStorage.setItem('tasks', JSON.stringify(tasks));
    localStorage.setItem('exams', JSON.stringify(exams));
    localStorage.setItem('courses', JSON.stringify(courses));
    localStorage.setItem('grades', JSON.stringify(grades));
}

// Render all data
function renderAll() {
    renderTasks();
    renderExams();
    renderCourses();
    renderGrades();
}

// Task functions
function addTask() {
    const taskInput = document.getElementById('taskInput');
    const taskDateInput = document.getElementById('taskDateInput');
    
    if (taskInput.value.trim() === '') return;
    
    const task = {
        id: Date.now(),
        text: taskInput.value.trim(),
        dueDate: taskDateInput.value,
        completed: false
    };
    
    tasks.push(task);
    saveData();
    renderTasks();
    
    taskInput.value = '';
    taskDateInput.value = '';
}

function toggleTask(id) {
    const task = tasks.find(task => task.id === id);
    if (task) {
        task.completed = !task.completed;
        saveData();
        renderTasks();
    }
}

function deleteTask(id) {
    tasks = tasks.filter(task => task.id !== id);
    saveData();
    renderTasks();
}

function renderTasks() {
    const taskList = document.getElementById('taskList');
    taskList.innerHTML = '';
    
    tasks.forEach(task => {
        const li = document.createElement('li');
        li.className = 'task-item' + (task.completed ? ' completed' : '');
        
        li.innerHTML = `
            <input type="checkbox" ${task.completed ? 'checked' : ''} onchange="toggleTask(${task.id})">
            <span>${task.text}</span>
            ${task.dueDate ? `<span class="due-date">(${new Date(task.dueDate).toLocaleDateString()})</span>` : ''}
            <button onclick="deleteTask(${task.id})">Delete</button>
        `;
        
        taskList.appendChild(li);
    });
}

// Exam functions
function addExam() {
    const examInput = document.getElementById('examInput');
    const examDateInput = document.getElementById('examDateInput');
    
    if (examInput.value.trim() === '') return;
    
    const exam = {
        id: Date.now(),
        text: examInput.value.trim(),
        date: examDateInput.value
    };
    
    exams.push(exam);
    saveData();
    renderExams();
    
    examInput.value = '';
    examDateInput.value = '';
}

function deleteExam(id) {
    exams = exams.filter(exam => exam.id !== id);
    saveData();
    renderExams();
}

function renderExams() {
    const examList = document.getElementById('examList');
    examList.innerHTML = '';
    
    exams.forEach(exam => {
        const li = document.createElement('li');
        li.className = 'examlist-item'; // Added the missing class
        
        li.innerHTML = `
            <span>${exam.text}</span>
            ${exam.date ? `<span class="exam-date">(${new Date(exam.date).toLocaleDateString()})</span>` : ''}
            <button onclick="deleteExam(${exam.id})">Delete</button>
        `;
        
        examList.appendChild(li);
    });
}

// Course functions
function addCourse() {
    const courseInput = document.getElementById('courseInput');
    
    if (courseInput.value.trim() === '') return;
    
    const course = {
        id: Date.now(),
        text: courseInput.value.trim()
    };
    
    courses.push(course);
    saveData();
    renderCourses();
    
    courseInput.value = '';
}

function deleteCourse(id) {
    courses = courses.filter(course => course.id !== id);
    saveData();
    renderCourses();
}

function renderCourses() {
    const courseList = document.getElementById('courseList');
    courseList.innerHTML = '';
    
    courses.forEach(course => {
        const li = document.createElement('li');
        li.className = 'add-course-item'; // Added class for consistency
        
        li.innerHTML = `
            <span>${course.text}</span>
            <button onclick="deleteCourse(${course.id})">Delete</button>
        `;
        
        courseList.appendChild(li);
    });
}

// Grade functions
function addGrade() {
    const courseNameInput = document.getElementById('courseNameInput');
    const gradeInput = document.getElementById('gradeInput');
    
    if (courseNameInput.value.trim() === '' || gradeInput.value.trim() === '') return;
    
    const grade = {
        id: Date.now(),
        course: courseNameInput.value.trim(),
        grade: gradeInput.value.trim()
    };
    
    grades.push(grade);
    saveData();
    renderGrades();
    
    courseNameInput.value = '';
    gradeInput.value = '';
}

function deleteGrade(id) {
    grades = grades.filter(grade => grade.id !== id);
    saveData();
    renderGrades();
}

function renderGrades() {
    const gradeTable = document.getElementById('gradeTable').querySelector('tbody');
    gradeTable.innerHTML = '';
    
    grades.forEach(grade => {
        const tr = document.createElement('tr');
        tr.className = 'add-grade-item'; // Added class for consistency
        
        tr.innerHTML = `
            <td>${grade.course}</td>
            <td>${grade.grade}</td>
            <td><button onclick="deleteGrade(${grade.id})">Delete</button></td>
        `;
        
        gradeTable.appendChild(tr);
    });
}

// Initialize the app
window.onload = function() {
    renderAll();
    
    // Ensure data is saved on page unload
    window.onbeforeunload =
    
    saveData();
    renderAll();
};

// AI Assistant functions
        async function askAI() {
            const input = document.getElementById('aiInput');
            const button = document.getElementById('aiButton');
            const chat = document.getElementById('aiChat');
            
            if (!input.value.trim()) return;
            
            // Add user message to chat
            const userMessage = document.createElement('div');
            userMessage.className = 'message user-message';
            userMessage.textContent = input.value;
            chat.appendChild(userMessage);
            
            // Add thinking indicator
            const thinking = document.createElement('div');
            thinking.className = 'message ai-message thinking';
            thinking.textContent = 'Thinking...';
            chat.appendChild(thinking);
            
            // Clear input and disable button
            const question = input.value;
            input.value = '';
            button.disabled = true;
            
            // Scroll to bottom
            chat.scrollTop = chat.scrollHeight;
            
            try {
                // Replace with your preferred AI API
                const response = await callAI(question);
                
                // Remove thinking indicator
                chat.removeChild(thinking);
                
                // Add AI response
                const aiMessage = document.createElement('div');
                aiMessage.className = 'message ai-message';
                aiMessage.textContent = response;
                chat.appendChild(aiMessage);
            } catch (error) {
                // Remove thinking indicator
                chat.removeChild(thinking);
                
                // Add error message
                const errorMessage = document.createElement('div');
                errorMessage.className = 'message ai-message';
                errorMessage.textContent = 'Sorry, I encountered an error. Please try again.';
                chat.appendChild(errorMessage);
                
                console.error('AI Error:', error);
            }
            
            // Re-enable button
            button.disabled = false;
            
            // Scroll to bottom
            chat.scrollTop = chat.scrollHeight;
        }
        
        // Function to call AI API (you need to implement this based on your chosen AI service)
        async function callAI(question) {
            // Option 1: OpenAI API (requires API key)
            // return await callOpenAI(question);
            
            // Option 2: Hugging Face API (free tier available)
            // return await callHuggingFace(question);
            
            // Option 3: Local AI (if you have one set up)
            // return await callLocalAI(question);
            
            // For now, returning a mock response
            return `I received your question: "${question}". This is a mock response. Set up a real AI API to get actual answers.`;
        }
        
        // Example implementation for OpenAI API
        async function callOpenAI(question) {
            // You need an OpenAI API key for this
            const apiKey = 'YOUR_OPENAI_API_KEY'; // Replace with your actual API key
            
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'gpt-3.5-turbo',
                    messages: [
                        {role: 'system', content: 'You are a helpful study assistant for college students.'},
                        {role: 'user', content: question}
                    ],
                    max_tokens: 500
                })
            });
            
            const data = await response.json();
            return data.choices[0].message.content;
        }
        
        
        async function callHuggingFace(question) {
            
            const apiToken = 'YOUR_HUGGING_FACE_TOKEN'; // Replace with your actual token
            
            const response = await fetch(
                'https://api-inference.huggingface.co/models/microsoft/DialoGPT-large',
                {
                    headers: { Authorization: `Bearer ${apiToken}` },
                    method: 'POST',
                    body: JSON.stringify({ inputs: question }),
                }
            );
            
            const result = await response.json();
            return result.generated_text;
        }
        
        
        document.getElementById('aiInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                askAI();
            }
        });
    </script>
</body>
</html>